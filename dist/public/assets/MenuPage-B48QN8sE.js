import{Q as G,a as A}from"./QTable-DTLu2Tvo.js";import{Q as $,a as b}from"./QTd-CFw_34pb.js";import{b as g,B as H,n as M,d as Q,o as r,f as i,a,w as d,e as E,V as C,h as o,C as J,m as V,c as y,Z as R,i as p,a0 as S,k as w,_ as q,a1 as K,Q as F,j as U,a2 as z}from"./index-C5b5Sw8_.js";import{Q as O}from"./QItemLabel-CvbnZFm2.js";import{Q as W}from"./QItem-CMptwB6V.js";import{a as X}from"./QField-Dvg6sB8p.js";import{Q as D}from"./QSpace-qN3MiCm1.js";import{Q as P}from"./QToolbar-L3qa-UlQ.js";import{C as k}from"./ClosePopup-HPU98ga6.js";import"./format-CJebrXOQ.js";const Y={class:"q-pa-md"},c={style:{display:"flex",gap:"16px"}},ee={style:{display:"flex",gap:"16px"}},le={style:{display:"flex",gap:"16px"}},fe={__name:"MenuPage",setup(ae){const Z=[{name:"id",required:!0,label:"id",align:"left",field:n=>n.id,format:n=>`${n}`,sortable:!0},{name:"name",required:!0,label:"name",align:"left",field:n=>n.name,format:n=>`${n}`,sortable:!0,style:"max-width: 50px;"},{name:"detail",required:!0,label:"detail",align:"left",field:n=>n.note,format:n=>`${n}`,sortable:!0,classes:"multiline-cell",style:{"max-width":"150px","white-space":"normal","word-break":"break-word"}}],I=g(""),B=g([]),f=g(null),u=g({});let m=["name","note","subname"];const x=["","_en","_cn"];let v=["id","price","category","tags"];const T=g(!1);function L(n,e){T.value=!0,N(e)}const _=g(!1);function h(n){_.value=!0,N(n)}function N(n){f.value=n;for(let e=0;e<m.length;e++)u.value[m[e]]=n[m[e]],u.value[m[e]+"_en"]=n[m[e]+"_en"],u.value[m[e]+"_cn"]=n[m[e]+"_cn"];u.value.disable=n.disable||!1;for(let e=0;e<v.length;e++)u.value[v[e]]=n[v[e]]}function j(){console.log("apply dish");let n={},e=!1;for(let l=0;l<m.length;l++)for(let t=0;t<x.length;t++){const s=m[l]+x[t];f.value[s]!=u.value[s]&&(n[s]=u.value[s],e=!0)}for(let l=0;l<v.length;l++){let t=v[l];f.value[t]!=u.value[t]&&(e=!0,n[t]=u.value[t])}if(f.value.disable?u.value.disable||(e=!0,n.disable=!1):u.value.disable&&(e=!0,n.disable=!0),e){for(let l=0;l<m.length;l++)for(let t=0;t<x.length;t++){const s=m[l]+x[t];f.value[s]=u.value[s]}f.value.disable=u.value.disable;for(let l=0;l<v.length;l++){let t=v[l];f.value[t]=u.value[t]}n.id=f.value.id,M.updateMenuItem(n),console.log("update apply dish",n)}}return H(()=>{console.log("..... onMounted ...");const n=[],e={};for(let l=0;l<M.menuData.length;l++){let t=M.menuData[l];if(e[t.handle]){let s=e[t.handle];s.subitems||(s.subitems=[s]),s.subitems.push(t)}else e[t.handle]=t,n.push(t)}B.value=n,console.log(B.value)}),(n,e)=>(r(),Q(C,null,[i("div",Y,[a(G,{title:"Dishes",rows:B.value,columns:Z,"row-key":"id",filter:I.value,onRowClick:L},{header:d(l=>[a($,{props:l},{default:d(()=>[a(A,{"auto-width":""}),(r(!0),Q(C,null,S(l.cols,t=>(r(),y(A,{key:t.name,props:l},{default:d(()=>[w(q(t.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:d(l=>[a($,{props:l},{default:d(()=>[a(b,{"auto-width":""},{default:d(()=>[l.row.subitems?R("",!0):(r(),y(p,{key:0,size:"sm",color:"accent",round:"",dense:""})),l.row.subitems?(r(),y(p,{key:1,size:"sm",color:"accent",round:"",dense:"",onClick:t=>l.expand=!l.expand,icon:l.expand?"remove":"add"},null,8,["onClick","icon"])):R("",!0)]),_:2},1024),(r(!0),Q(C,null,S(l.cols,t=>(r(),y(b,{key:t.name,props:l},{default:d(()=>[w(q(t.value),1)]),_:2},1032,["props"]))),128)),a(b,{"auto-width":""},{default:d(()=>[a(p,{color:"primary",dense:"",onClick:t=>L(null,l.row),label:"edit"},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["props"]),V(a($,{props:l},{default:d(()=>[l.row.subitems?(r(),y(b,{key:0,colspan:"100%"},{default:d(()=>[a(X,{bordered:"",class:"rounded-borders",style:{"max-width":"600px"}},{default:d(()=>[a(O,{header:""},{default:d(()=>e[20]||(e[20]=[w("sub item")])),_:1,__:[20]}),(r(!0),Q(C,null,S(l.row.subitems,t=>(r(),y(W,{key:t.id},{default:d(()=>[a(b,{style:{width:"50px"}},{default:d(()=>[w(q(t.id),1)]),_:2},1024),a(b,{style:{width:"150px"}},{default:d(()=>[w(q(t.subname),1)]),_:2},1024),a(b,{"auto-width":""},{default:d(()=>[a(p,{color:"primary",dense:"",onClick:s=>h(t),label:"edit"},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)):R("",!0)]),_:2},1032,["props"]),[[K,l.expand]])]),"top-right":d(()=>[a(o,{borderless:"",dense:"",debounce:"300",modelValue:I.value,"onUpdate:modelValue":e[0]||(e[0]=l=>I.value=l),placeholder:"Search"},{append:d(()=>[a(J,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["rows","filter"])]),a(E,{modelValue:T.value,"onUpdate:modelValue":e[12]||(e[12]=l=>T.value=l),"full-height":"","full-width":""},{default:d(()=>[a(F,null,{default:d(()=>[a(U,{class:"row items-center q-pb-none"},{default:d(()=>[e[21]||(e[21]=i("div",{class:"text-h6"},"Edit Dish",-1)),a(D),V(a(p,{icon:"close",flat:"",round:"",dense:""},null,512),[[k]])]),_:1,__:[21]}),a(U,{class:"q-pa-sm q-gutter-sm"},{default:d(()=>[a(z,{modelValue:u.value.disable,"onUpdate:modelValue":e[1]||(e[1]=l=>u.value.disable=l),label:"Disable"},null,8,["modelValue"]),e[22]||(e[22]=i("div",{class:"q-ma-lg"},null,-1)),a(o,{outlined:"",modelValue:u.value.name,"onUpdate:modelValue":e[2]||(e[2]=l=>u.value.name=l),label:"name(pt)",dense:n.dense},null,8,["modelValue","dense"]),a(o,{outlined:"",modelValue:u.value.name_en,"onUpdate:modelValue":e[3]||(e[3]=l=>u.value.name_en=l),label:"name(english)",dense:n.dense},null,8,["modelValue","dense"]),a(o,{outlined:"",modelValue:u.value.name_cn,"onUpdate:modelValue":e[4]||(e[4]=l=>u.value.name_cn=l),label:"name(中文)",dense:n.dense},null,8,["modelValue","dense"]),e[23]||(e[23]=i("div",{class:"q-ma-lg"},null,-1)),a(o,{outlined:"",modelValue:u.value.note,"onUpdate:modelValue":e[5]||(e[5]=l=>u.value.note=l),label:"descript(pt)",dense:n.dense},null,8,["modelValue","dense"]),a(o,{outlined:"",modelValue:u.value.note_en,"onUpdate:modelValue":e[6]||(e[6]=l=>u.value.note_en=l),label:"descript(english)",dense:n.dense},null,8,["modelValue","dense"]),a(o,{outlined:"",modelValue:u.value.note_cn,"onUpdate:modelValue":e[7]||(e[7]=l=>u.value.note_cn=l),label:"descript(中文)",dense:n.dense},null,8,["modelValue","dense"]),e[24]||(e[24]=i("div",{class:"q-ma-lg"},null,-1)),i("div",c,[a(o,{outlined:"",modelValue:u.value.id,"onUpdate:modelValue":e[8]||(e[8]=l=>u.value.id=l),label:"id",style:{flex:"1"}},null,8,["modelValue"]),a(o,{outlined:"",modelValue:u.value.price,"onUpdate:modelValue":e[9]||(e[9]=l=>u.value.price=l),label:"price",type:"number",prefix:"€",style:{flex:"1"}},null,8,["modelValue"])]),i("div",ee,[a(o,{outlined:"",modelValue:u.value.category,"onUpdate:modelValue":e[10]||(e[10]=l=>u.value.category=l),label:"category",style:{flex:"1"}},null,8,["modelValue"]),a(o,{outlined:"",modelValue:u.value.tags,"onUpdate:modelValue":e[11]||(e[11]=l=>u.value.tags=l),label:"tags",style:{flex:"1"}},null,8,["modelValue"])]),e[25]||(e[25]=i("div",{class:"q-ma-lg"},null,-1))]),_:1,__:[22,23,24,25]}),a(P,{class:"q-gutter-lg q-mb-lg"},{default:d(()=>[a(D),V(a(p,{align:"right",label:"Cancel"},null,512),[[k]]),V(a(p,{align:"left",color:"primary",label:"Apply",onClick:j},null,512),[[k]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(E,{modelValue:_.value,"onUpdate:modelValue":e[19]||(e[19]=l=>_.value=l),"full-height":"","full-width":""},{default:d(()=>[a(F,null,{default:d(()=>[a(U,{class:"row items-center q-pb-none"},{default:d(()=>[e[26]||(e[26]=i("div",{class:"text-h6"},"Edit Item",-1)),a(D),V(a(p,{icon:"close",flat:"",round:"",dense:""},null,512),[[k]])]),_:1,__:[26]}),a(U,{class:"q-pa-sm q-gutter-sm"},{default:d(()=>[a(z,{modelValue:u.value.disable,"onUpdate:modelValue":e[13]||(e[13]=l=>u.value.disable=l),label:"Disable"},null,8,["modelValue"]),e[27]||(e[27]=i("div",{class:"q-ma-lg"},null,-1)),a(o,{outlined:"",modelValue:u.value.subname,"onUpdate:modelValue":e[14]||(e[14]=l=>u.value.subname=l),label:"subname(pt)",dense:n.dense},null,8,["modelValue","dense"]),a(o,{outlined:"",modelValue:u.value.subname_en,"onUpdate:modelValue":e[15]||(e[15]=l=>u.value.subname_en=l),label:"subname(english)",dense:n.dense},null,8,["modelValue","dense"]),a(o,{outlined:"",modelValue:u.value.subname_cn,"onUpdate:modelValue":e[16]||(e[16]=l=>u.value.subname_cn=l),label:"subname(中文)",dense:n.dense},null,8,["modelValue","dense"]),e[28]||(e[28]=i("div",{class:"q-ma-lg"},null,-1)),i("div",le,[a(o,{outlined:"",modelValue:u.value.id,"onUpdate:modelValue":e[17]||(e[17]=l=>u.value.id=l),label:"id",style:{flex:"1"}},null,8,["modelValue"]),a(o,{outlined:"",modelValue:u.value.price,"onUpdate:modelValue":e[18]||(e[18]=l=>u.value.price=l),label:"price",type:"number",prefix:"€",style:{flex:"1"}},null,8,["modelValue"])]),e[29]||(e[29]=i("div",{class:"q-ma-lg"},null,-1))]),_:1,__:[27,28,29]}),a(P,{class:"q-gutter-lg q-mb-lg"},{default:d(()=>[a(D),V(a(p,{align:"right",label:"Cancel"},null,512),[[k]]),V(a(p,{align:"left",color:"primary",label:"Apply",onClick:j},null,512),[[k]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{fe as default};
