import{s as W}from"./index-Dzk7cjB5.js";import{s as H}from"./index-CLxheRKH.js";import{h as k,f as D,o as d,w as v,a as u,b as a,B as Q,c as y,e as $,m as C,d as S,F as V,s as X,t as B,q as M,r as q,L as P,g as N,M as U,N as Y,K as Z,O as _,E,x as F,k as L,J as ee,u as te}from"./index-DOi7WD0x.js";import{s as ne}from"./index-m3lhnhag.js";import{c as I,b as G}from"./index-DsByIwCv.js";import{s as oe}from"./index-8uv1ZgZl.js";import{s as le}from"./index-DNVMnce_.js";import{s as ae}from"./index-BkaebiXV.js";import{Q as ie,C as z}from"./CodeMaker-CgE_MWay.js";import{a as se,d as re,s as ce}from"./index-CVxjzhn1.js";import"./index-CmU7fJgm.js";import"./index-DaXBifmJ.js";const de={class:"p-menuitem-content"},ue={__name:"TableMenuBar",props:{filterStatu:String},setup(e){const n=k([{label:"全部",value:"Todos",icon:"pi pi-circle-fill",severity:"contrast"},{label:"空闲",value:"Livre",icon:"pi pi-circle-fill",severity:"success"},{label:"用餐",value:"Ocupado",icon:"pi pi-circle-fill",severity:"danger"},{label:"预定",value:"Reservado",icon:"pi pi-circle-fill",severity:"info"},{label:"已付",value:"Pago",icon:"pi pi-circle-fill",severity:"help"}]);return(c,p)=>{const t=I,o=ne;return d(),D(o,{model:n.value,breakpoint:"355px"},{item:v(({item:i})=>[u("div",de,[a(t,{label:i.label,icon:i.icon,severity:i.severity,variant:"outlined",raised:"",onClick:r=>c.$emit("update:filterStatu",i.value)},null,8,["label","icon","severity","onClick"])])]),_:1},8,["model"])}}};var pe=`
    .p-card {
        background: dt('card.background');
        color: dt('card.color');
        box-shadow: dt('card.shadow');
        border-radius: dt('card.border.radius');
        display: flex;
        flex-direction: column;
    }

    .p-card-caption {
        display: flex;
        flex-direction: column;
        gap: dt('card.caption.gap');
    }

    .p-card-body {
        padding: dt('card.body.padding');
        display: flex;
        flex-direction: column;
        gap: dt('card.body.gap');
    }

    .p-card-title {
        font-size: dt('card.title.font.size');
        font-weight: dt('card.title.font.weight');
    }

    .p-card-subtitle {
        color: dt('card.subtitle.color');
    }
`,fe={root:"p-card p-component",header:"p-card-header",body:"p-card-body",caption:"p-card-caption",title:"p-card-title",subtitle:"p-card-subtitle",content:"p-card-content",footer:"p-card-footer"},me=Q.extend({name:"card",style:pe,classes:fe}),be={name:"BaseCard",extends:G,style:me,provide:function(){return{$pcCard:this,$parentInstance:this}}},J={name:"Card",extends:be,inheritAttrs:!1};function ve(e,n,c,p,t,o){return d(),y("div",C({class:e.cx("root")},e.ptmi("root")),[e.$slots.header?(d(),y("div",C({key:0,class:e.cx("header")},e.ptm("header")),[S(e.$slots,"header")],16)):$("",!0),u("div",C({class:e.cx("body")},e.ptm("body")),[e.$slots.title||e.$slots.subtitle?(d(),y("div",C({key:0,class:e.cx("caption")},e.ptm("caption")),[e.$slots.title?(d(),y("div",C({key:0,class:e.cx("title")},e.ptm("title")),[S(e.$slots,"title")],16)):$("",!0),e.$slots.subtitle?(d(),y("div",C({key:1,class:e.cx("subtitle")},e.ptm("subtitle")),[S(e.$slots,"subtitle")],16)):$("",!0)],16)):$("",!0),u("div",C({class:e.cx("content")},e.ptm("content")),[S(e.$slots,"content")],16),e.$slots.footer?(d(),y("div",C({key:1,class:e.cx("footer")},e.ptm("footer")),[S(e.$slots,"footer")],16)):$("",!0)],16)],16)}J.render=ve;const ye={class:"overflow-auto",style:{height:"calc(100vh - 250px)"}},ge={class:"grid m-2"},he={class:"text-center text-2xl font-bold"},Te={class:"text-center"},ke={class:"text-center text-lg"},Ce={class:"text-center text-lg font-bold"},$e={__name:"TableGrid",props:{filteredTables:Array},setup(e){const n=k([{label:"空闲",value:"Livre"},{label:"用餐",value:"Ocupado"},{label:"预定",value:"Reservado"},{label:"已付",value:"Pago"}]);function c(o){return n.value.find(i=>i.value===o)}function p(o){return!o||!Array.isArray(o)?0:parseFloat(o.reduce((i,r)=>i+r.price*r.quantity,0).toFixed(2))}function t(o){const i="m-1 border-3 border-gray-500 ";let r="";switch(o){case"Livre":break;case"Ocupado":r="border-red-300 bg-red-100";break;case"Reservado":r="border-blue-300 bg-blue-100";break;case"Pago":r="border-purple-300 bg-purple-100";break;default:r="border-gray-500 bg-gray-100"}return i+r}return(o,i)=>{const r=J;return d(),y("div",ye,[u("div",ge,[(d(!0),y(V,null,X(e.filteredTables,f=>(d(),D(r,{class:M(t(f.status)),style:{"min-width":"150px","min-height":"150px","max-width":"175px","max-height":"175px"},onClick:j=>o.$emit("openTableDetail",f.id)},{content:v(()=>[u("p",he,"桌号: "+B(f.id),1),u("p",Te,B(c(f.status).label),1),u("p",ke,B(f.people)+"人",1),u("p",Ce,B(p(f.order))+"€",1)]),_:2},1032,["class","onClick"]))),256))])])}}};var we=`
    .p-confirmdialog .p-dialog-content {
        display: flex;
        align-items: center;
        gap: dt('confirmdialog.content.gap');
    }

    .p-confirmdialog-icon {
        color: dt('confirmdialog.icon.color');
        font-size: dt('confirmdialog.icon.size');
        width: dt('confirmdialog.icon.size');
        height: dt('confirmdialog.icon.size');
    }
`,je={root:"p-confirmdialog",icon:"p-confirmdialog-icon",message:"p-confirmdialog-message",pcRejectButton:"p-confirmdialog-reject-button",pcAcceptButton:"p-confirmdialog-accept-button"},Ee=Q.extend({name:"confirmdialog",style:we,classes:je}),Se={name:"BaseConfirmDialog",extends:G,props:{group:String,breakpoints:{type:Object,default:null},draggable:{type:Boolean,default:!0}},style:Ee,provide:function(){return{$pcConfirmDialog:this,$parentInstance:this}}},K={name:"ConfirmDialog",extends:Se,confirmListener:null,closeListener:null,data:function(){return{visible:!1,confirmation:null}},mounted:function(){var n=this;this.confirmListener=function(c){c&&c.group===n.group&&(n.confirmation=c,n.confirmation.onShow&&n.confirmation.onShow(),n.visible=!0)},this.closeListener=function(){n.visible=!1,n.confirmation=null},U.on("confirm",this.confirmListener),U.on("close",this.closeListener)},beforeUnmount:function(){U.off("confirm",this.confirmListener),U.off("close",this.closeListener)},methods:{accept:function(){this.confirmation.accept&&this.confirmation.accept(),this.visible=!1},reject:function(){this.confirmation.reject&&this.confirmation.reject(),this.visible=!1},onHide:function(){this.confirmation.onHide&&this.confirmation.onHide(),this.visible=!1}},computed:{appendTo:function(){return this.confirmation?this.confirmation.appendTo:"body"},target:function(){return this.confirmation?this.confirmation.target:null},modal:function(){return this.confirmation?this.confirmation.modal==null?!0:this.confirmation.modal:!0},header:function(){return this.confirmation?this.confirmation.header:null},message:function(){return this.confirmation?this.confirmation.message:null},blockScroll:function(){return this.confirmation?this.confirmation.blockScroll:!0},position:function(){return this.confirmation?this.confirmation.position:null},acceptLabel:function(){if(this.confirmation){var n,c=this.confirmation;return c.acceptLabel||((n=c.acceptProps)===null||n===void 0?void 0:n.label)||this.$primevue.config.locale.accept}return this.$primevue.config.locale.accept},rejectLabel:function(){if(this.confirmation){var n,c=this.confirmation;return c.rejectLabel||((n=c.rejectProps)===null||n===void 0?void 0:n.label)||this.$primevue.config.locale.reject}return this.$primevue.config.locale.reject},acceptIcon:function(){var n;return this.confirmation?this.confirmation.acceptIcon:(n=this.confirmation)!==null&&n!==void 0&&n.acceptProps?this.confirmation.acceptProps.icon:null},rejectIcon:function(){var n;return this.confirmation?this.confirmation.rejectIcon:(n=this.confirmation)!==null&&n!==void 0&&n.rejectProps?this.confirmation.rejectProps.icon:null},autoFocusAccept:function(){return this.confirmation.defaultFocus===void 0||this.confirmation.defaultFocus==="accept"},autoFocusReject:function(){return this.confirmation.defaultFocus==="reject"},closeOnEscape:function(){return this.confirmation?this.confirmation.closeOnEscape:!0}},components:{Dialog:H,Button:I}};function Be(e,n,c,p,t,o){var i=q("Button"),r=q("Dialog");return d(),D(r,{visible:t.visible,"onUpdate:visible":[n[2]||(n[2]=function(f){return t.visible=f}),o.onHide],role:"alertdialog",class:M(e.cx("root")),modal:o.modal,header:o.header,blockScroll:o.blockScroll,appendTo:o.appendTo,position:o.position,breakpoints:e.breakpoints,closeOnEscape:o.closeOnEscape,draggable:e.draggable,pt:e.pt,unstyled:e.unstyled},P({default:v(function(){return[e.$slots.container?$("",!0):(d(),y(V,{key:0},[e.$slots.message?(d(),D(N(e.$slots.message),{key:1,message:t.confirmation},null,8,["message"])):(d(),y(V,{key:0},[S(e.$slots,"icon",{},function(){return[e.$slots.icon?(d(),D(N(e.$slots.icon),{key:0,class:M(e.cx("icon"))},null,8,["class"])):t.confirmation.icon?(d(),y("span",C({key:1,class:[t.confirmation.icon,e.cx("icon")]},e.ptm("icon")),null,16)):$("",!0)]}),u("span",C({class:e.cx("message")},e.ptm("message")),B(o.message),17)],64))],64))]}),_:2},[e.$slots.container?{name:"container",fn:v(function(f){return[S(e.$slots,"container",{message:t.confirmation,closeCallback:f.onclose,acceptCallback:o.accept,rejectCallback:o.reject})]}),key:"0"}:void 0,e.$slots.container?void 0:{name:"footer",fn:v(function(){var f;return[a(i,C({class:[e.cx("pcRejectButton"),t.confirmation.rejectClass],autofocus:o.autoFocusReject,unstyled:e.unstyled,text:((f=t.confirmation.rejectProps)===null||f===void 0?void 0:f.text)||!1,onClick:n[0]||(n[0]=function(j){return o.reject()})},t.confirmation.rejectProps,{label:o.rejectLabel,pt:e.ptm("pcRejectButton")}),P({_:2},[o.rejectIcon||e.$slots.rejecticon?{name:"icon",fn:v(function(j){return[S(e.$slots,"rejecticon",{},function(){return[u("span",C({class:[o.rejectIcon,j.class]},e.ptm("pcRejectButton").icon,{"data-pc-section":"rejectbuttonicon"}),null,16)]})]}),key:"0"}:void 0]),1040,["class","autofocus","unstyled","text","label","pt"]),a(i,C({label:o.acceptLabel,class:[e.cx("pcAcceptButton"),t.confirmation.acceptClass],autofocus:o.autoFocusAccept,unstyled:e.unstyled,onClick:n[1]||(n[1]=function(j){return o.accept()})},t.confirmation.acceptProps,{pt:e.ptm("pcAcceptButton")}),P({_:2},[o.acceptIcon||e.$slots.accepticon?{name:"icon",fn:v(function(j){return[S(e.$slots,"accepticon",{},function(){return[u("span",C({class:[o.acceptIcon,j.class]},e.ptm("pcAcceptButton").icon,{"data-pc-section":"acceptbuttonicon"}),null,16)]})]}),key:"0"}:void 0]),1040,["label","class","autofocus","unstyled","pt"])]}),key:"1"}]),1032,["visible","class","modal","header","blockScroll","appendTo","position","breakpoints","closeOnEscape","draggable","onUpdate:visible","pt","unstyled"])}K.render=Be;const De={class:"flex flex-column justify-content-center align-items-center"},Le={key:0,class:"flex flex-wrap justify-content-center align-items-center"},Oe={key:1,class:"flex flex-wrap justify-content-center align-items-center"},Ve={class:"flex flex-wrap justify-content-center align-items-center m-2"},xe={class:"flex flex-wrap justify-content-center align-items-center m-3 mb-5"},Ae={class:"m-2"},Fe={key:0,class:"flex flex-wrap justify-content-between align-items-center"},Re={key:1},Ue={__name:"TableDetail",props:{selectedTable:Object,isEditTable:Boolean},emits:["tableEditableMode","tableEditCancel","tableEditConfirm","cleanTable","showTableOrders","showToast"],setup(e,{emit:n}){const c=e,p=n,t=c.selectedTable,o=k([{label:"空闲",value:"Livre",severity:"success"},{label:"用餐",value:"Ocupado",severity:"danger"},{label:"预定",value:"Reservado",severity:"info"},{label:"已付",value:"Pago",severity:"help"}]);function i(){return o.value.find(T=>T.value===t.status)}function r(T,l){if(T==="Adult"){if(t.peopleType.adults<=0&&l<=0)return;t.peopleType.adults+=l}else if(T==="Children"){if(t.peopleType.children<=0&&l<=0)return;t.peopleType.children+=l}t.people=t.peopleType.adults+t.peopleType.children,f()}function f(){p("update:selectedTable",t)}const j=Y(),O=()=>{j.require({message:"是否清空"+t.id+"号桌",header:"确认清台",icon:"pi pi-info-circle",rejectLabel:"取消",rejectProps:{label:"取消",severity:"secondary",outlined:!0},acceptProps:{label:"确认",severity:"danger"},accept:()=>{p("showToast","info","操作","桌号"+t.id+"，清台"),p("cleanTable",t.id)},reject:()=>{p("showToast","error","操作","取消"+t.id+"号桌清台")}})},w=k(null);function x(){window.open(window.env.QR_ADDR+z.SimpleEncode(c.selectedTable.id),"_blank")}const R=async()=>{if(w.value)try{await ie.toCanvas(w.value,window.env.QR_ADDR+z.SimpleEncode(c.selectedTable.id),{width:175,margin:2,color:{dark:"#000000",light:"#ffffff"}})}catch(T){console.error("生成二维码失败:",T)}};return Z(()=>{R()}),_(()=>window.env.QR_ADDR+z.SimpleEncode(c.selectedTable.id),R),(T,l)=>{const m=ae,s=le,b=I,A=oe,g=K;return d(),y(V,null,[u("div",De,[u("div",null,[a(s,{class:"m-2",variant:"on"},{default:v(()=>[a(m,{id:"Total",modelValue:E(t).people,"onUpdate:modelValue":l[0]||(l[0]=h=>E(t).people=h),autocomplete:"off",disabled:""},null,8,["modelValue"]),l[12]||(l[12]=u("label",{for:"Total"},"总人数",-1))]),_:1,__:[12]})]),e.isEditTable?(d(),y("div",Le,[a(b,{icon:"pi pi-minus",rounded:"","aria-label":"Filter",size:"small",onClick:l[1]||(l[1]=h=>r("Adult",-1))}),a(s,{class:"m-2",variant:"on"},{default:v(()=>[a(m,{id:"Adult",modelValue:E(t).peopleType.adults,"onUpdate:modelValue":l[2]||(l[2]=h=>E(t).peopleType.adults=h),autocomplete:"off"},null,8,["modelValue"]),l[13]||(l[13]=u("label",{for:"Adult"},"大人",-1))]),_:1,__:[13]}),a(b,{icon:"pi pi-plus",rounded:"","aria-label":"Filter",size:"small",onClick:l[3]||(l[3]=h=>r("Adult",1))})])):$("",!0),e.isEditTable?(d(),y("div",Oe,[a(b,{icon:"pi pi-minus",rounded:"","aria-label":"Filter",size:"small",onClick:l[4]||(l[4]=h=>r("Children",-1))}),a(s,{class:"m-2",variant:"on"},{default:v(()=>[a(m,{id:"Children",modelValue:E(t).peopleType.children,"onUpdate:modelValue":l[5]||(l[5]=h=>E(t).peopleType.children=h),autocomplete:"off"},null,8,["modelValue"]),l[14]||(l[14]=u("label",{for:"Children"},"小孩",-1))]),_:1,__:[14]}),a(b,{icon:"pi pi-plus",rounded:"","aria-label":"Filter",size:"small",onClick:l[6]||(l[6]=h=>r("Children",1))})])):$("",!0)]),u("div",Ve,[e.isEditTable?$("",!0):(d(),D(b,{key:0,icon:"pi pi-circle-fill",variant:"outlined",label:i().label,severity:i().severity},null,8,["label","severity"])),e.isEditTable?(d(),D(A,{key:1,modelValue:E(t).status,"onUpdate:modelValue":l[7]||(l[7]=h=>E(t).status=h),options:o.value,optionLabel:"label",optionValue:"value"},null,8,["modelValue","options"])):$("",!0)]),u("div",xe,[u("canvas",{ref_key:"qrCanvas",ref:w,class:"p-1",style:{border:"2px solid #b0b0b0","border-radius":"10px"},onClick:x},null,512)]),u("div",Ae,[e.isEditTable?$("",!0):(d(),y("div",Fe,[a(b,{label:"订单详情",onClick:l[8]||(l[8]=h=>T.$emit("showTableOrders"))}),a(g),a(b,{label:"清台",onClick:O,severity:"danger",class:"m-1"}),a(b,{label:"编辑",onClick:l[9]||(l[9]=h=>T.$emit("tableEditableMode")),class:"m-1"})])),e.isEditTable?(d(),y("div",Re,[a(b,{label:"取消编辑",severity:"danger",raised:"",class:"m-2",onClick:l[10]||(l[10]=h=>T.$emit("tableEditCancel"))}),a(b,{label:"保存编辑",severity:"success",raised:"",class:"m-2",onClick:l[11]||(l[11]=h=>{T.$emit("tableEditCancel"),T.$emit("tableEditConfirm",E(t))})})])):$("",!0)])],64)}}},Ie={class:"flex flex-wrap justify-content-end justify-content-between mt-1"},Pe={__name:"TableOrderView",props:{selectedTable:Object},setup(e){const n=e;function c(o){let i=0;return o.forEach(r=>{i+=r.price*r.quantity}),i.toFixed(2)}const p=n.selectedTable.order.value.sort((o,i)=>i.price-o.price),t=k(!1);return console.log("TableOrderView props:",n.selectedTable.order),console.log("TableOrderView orders:",p),(o,i)=>{const r=se,f=re,j=ce,O=I;return d(),y(V,null,[u("div",null,[a(j,{value:E(p),scrollable:"",scrollHeight:"flex",style:{"max-height":"350px"}},{default:v(()=>[a(r,{field:"dishid",header:"号码"}),a(r,{header:"菜名"},{body:v(w=>[F(B(E(L).getDishName(w.data)),1)]),default:v(()=>[i[0]||(i[0]=F("> "))]),_:1,__:[0]}),a(r,{field:"price",header:"单价"}),a(r,{field:"quantity",header:"数量"},{body:v(w=>[F(B(w.data.quantity)+" ",1),t.value?(d(),D(f,{key:0,modelValue:w.data.quantity,"onUpdate:modelValue":x=>w.data.quantity=x,inputId:"minmax-buttons",mode:"decimal",showButtons:"",min:0,max:99,"aria-disabled":"true",style:{width:"6rem"},fluid:""},null,8,["modelValue","onUpdate:modelValue"])):$("",!0)]),_:1}),a(r,{header:"总价"},{body:v(w=>[F(B(c([w.data])),1)]),default:v(()=>[i[1]||(i[1]=F("> "))]),_:1,__:[1]})]),_:1},8,["value"])]),u("div",Ie,[a(O,{label:"abc"})])],64)}}},Ze={__name:"TablesPage",setup(e){const n=k("Todos");k(!1),k(!1);const c=k(!1),p=k({id:0}),t=k(!1),o=k(!1);k(!1),k({});const i=ee(()=>n.value==="Todos"?L.tables.value:L.tables.value.filter(m=>m.status===n.value));function r(m){const s=L.tables.value.find(b=>b.id===m);p.value={...s,order:s?.order||[]},c.value=!0}function f(){t.value=!0}function j(m){const s={id:m.id,status:m.status,peopleType:{adults:m.peopleType.adults,children:m.peopleType.children}},b=L.updateTable(s);b&&console.log("tableEditConfirm Error:",b),t.value=!1}function O(){t.value=!1,c.value=!1}function w(){t.value=!1}function x(m){const s=L.tableClean(m);s&&console.log("cleanTable Error:",s),O()}function R(){const m=L.tables.value.find(s=>s.id===p.value.id);p.value={...m,order:m?.order||[]},o.value=!0}const T=te();function l(m,s,b,A){T.add({severity:m||"",summary:s||"",detail:b||"",life:A||3e3})}return(m,s)=>{const b=H,A=W;return d(),y(V,null,[a(ue,{filterStatu:n.value,"onUpdate:filterStatu":s[0]||(s[0]=g=>n.value=g)},null,8,["filterStatu"]),a($e,{filteredTables:i.value,"onUpdate:filteredTables":s[1]||(s[1]=g=>i.value=g),onOpenTableDetail:r},null,8,["filteredTables"]),a(b,{visible:c.value,"onUpdate:visible":s[4]||(s[4]=g=>c.value=g),header:"桌号: "+p.value.id,class:"m-0 p-0",modal:!0,dismissableMask:!0,style:{"min-width":"350px","max-width":"550px"},onHide:O},{default:v(()=>[a(Ue,{selectedTable:p.value,"onUpdate:selectedTable":s[2]||(s[2]=g=>p.value=g),isEditTable:t.value,"onUpdate:isEditTable":s[3]||(s[3]=g=>t.value=g),onTableEditableMode:f,onTableEditCancel:w,onTableEditConfirm:j,onCleanTable:x,onShowTableOrders:R,onShowToast:l},null,8,["selectedTable","isEditTable"])]),_:1},8,["visible","header"]),a(b,{visible:o.value,"onUpdate:visible":s[6]||(s[6]=g=>o.value=g),modal:!0,dismissableMask:!0,header:"菜品详情",style:{"min-width":"350px","max-width":"550px"}},{default:v(()=>[a(Pe,{selectedTable:p.value,"onUpdate:selectedTable":s[5]||(s[5]=g=>p.value=g)},null,8,["selectedTable"])]),_:1},8,["visible"]),a(A)],64)}}};export{Ze as default};
